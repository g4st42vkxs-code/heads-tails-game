<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Heads & Tails</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }

        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .container {
            max-width: 500px;
            width: 100%;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        h1 {
            text-align: center;
            color: #00d4ff;
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 0 0 10px rgba(0, 212, 255, 0.5);
        }

        .balance-container {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 25px;
            text-align: center;
            border: 1px solid rgba(0, 212, 255, 0.2);
        }

        .balance-label {
            font-size: 1.2rem;
            color: #aaa;
            margin-bottom: 5px;
        }

        .balance-amount {
            font-size: 3rem;
            font-weight: bold;
            color: #00ff88;
            text-shadow: 0 0 10px rgba(0, 255, 136, 0.5);
        }

        .min-bet {
            text-align: center;
            color: #ffaa00;
            margin-bottom: 30px;
            font-size: 1.1rem;
        }

        .coin-container {
            position: relative;
            width: 150px;
            height: 150px;
            margin: 30px auto;
            perspective: 1000px;
        }

        .coin {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.1s;
        }

        .coin-side {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            backface-visibility: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            font-weight: bold;
            box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.5);
        }

        .heads {
            background: linear-gradient(45deg, #ffd700, #ffaa00);
            color: #8b6914;
            border: 5px solid #daa520;
        }

        .tails {
            background: linear-gradient(45deg, #c0c0c0, #a0a0a0);
            color: #505050;
            border: 5px solid #808080;
            transform: rotateY(180deg);
        }

        .bet-selection {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
        }

        .bet-button {
            flex: 1;
            padding: 20px;
            border: none;
            border-radius: 15px;
            font-size: 1.5rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            color: white;
        }

        .bet-heads {
            background: linear-gradient(45deg, #ffaa00, #ff8800);
        }

        .bet-tails {
            background: linear-gradient(45deg, #888888, #666666);
        }

        .bet-button:hover:not(:disabled) {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }

        .bet-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .bet-amount {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid #00d4ff;
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
        }

        .bet-amount input {
            width: 100%;
            background: transparent;
            border: none;
            color: white;
            font-size: 1.5rem;
            text-align: center;
            outline: none;
        }

        .bet-amount input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
        }

        .action-button {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 15px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            color: white;
        }

        .deposit {
            background: linear-gradient(45deg, #00a86b, #008c5e);
        }

        .withdraw {
            background: linear-gradient(45deg, #ff416c, #ff4b2b);
        }

        .action-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .history {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            max-height: 200px;
            overflow-y: auto;
        }

        .history h3 {
            color: #00d4ff;
            margin-bottom: 15px;
            text-align: center;
        }

        .history-item {
            padding: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.9rem;
        }

        .history-item:last-child {
            border-bottom: none;
        }

        .win {
            color: #00ff88;
        }

        .lose {
            color: #ff5555;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: #1a1a2e;
            border-radius: 20px;
            padding: 30px;
            max-width: 400px;
            width: 90%;
            border: 2px solid #00d4ff;
        }

        .modal h2 {
            color: #00d4ff;
            margin-bottom: 20px;
            text-align: center;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #aaa;
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border-radius: 10px;
            border: 1px solid #00d4ff;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1rem;
        }

        .form-buttons {
            display: flex;
            gap: 10px;
        }

        .form-buttons button {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .submit {
            background: linear-gradient(45deg, #00a86b, #008c5e);
            color: white;
        }

        .cancel {
            background: linear-gradient(45deg, #ff416c, #ff4b2b);
            color: white;
        }

        .result-message {
            text-align: center;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-weight: bold;
            font-size: 1.2rem;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes spin {
            0% { transform: rotateY(0); }
            100% { transform: rotateY(3600deg); }
        }

        @keyframes flipHeads {
            0% { transform: rotateY(0); }
            100% { transform: rotateY(1800deg); }
        }

        @keyframes flipTails {
            0% { transform: rotateY(0); }
            100% { transform: rotateY(1980deg); }
        }

        .spinning {
            animation: spin 3s cubic-bezier(0.1, 0.7, 1.0, 0.1) infinite;
        }

        .show-heads {
            animation: flipHeads 2s ease-out forwards;
        }

        .show-tails {
            animation: flipTails 2s ease-out forwards;
        }

        .status-pending {
            color: #ffaa00;
        }

        .status-completed {
            color: #00ff88;
        }

        .status-rejected {
            color: #ff5555;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>HEADS & TAILS</h1>
        
        <div class="balance-container">
            <div class="balance-label">Balance</div>
            <div class="balance-amount" id="balanceAmount">0.00 USDT</div>
        </div>
        
        <div class="min-bet">Min bet: 0.25 USDT</div>
        
        <div class="coin-container">
            <div class="coin" id="coin">
                <div class="coin-side heads">H</div>
                <div class="coin-side tails">T</div>
            </div>
        </div>
        
        <div class="bet-selection">
            <button class="bet-button bet-heads" onclick="selectSide('heads')">HEADS</button>
            <button class="bet-button bet-tails" onclick="selectSide('tails')">TAILS</button>
        </div>
        
        <div class="bet-amount">
            <input type="number" id="betAmount" placeholder="Enter bet amount" step="0.25" min="0.25" value="0.25">
        </div>
        
        <div class="result-message" id="resultMessage"></div>
        
        <div class="action-buttons">
            <button class="action-button deposit" onclick="showDepositModal()">DEPOSIT</button>
            <button class="action-button withdraw" onclick="showWithdrawModal()">WITHDRAW</button>
        </div>
        
        <div class="history">
            <h3>Bet History</h3>
            <div id="betHistory"></div>
        </div>
    </div>
    
    <!-- Deposit Modal -->
    <div class="modal" id="depositModal">
        <div class="modal-content">
            <h2>Deposit USDT</h2>
            <p style="text-align: center; margin-bottom: 20px; color: #aaa;">
                Send USDT to the following address:
            </p>
            <div class="form-group">
                <label>Wallet Address (TRC20):</label>
                <input type="text" value="TG1ZPKvACH1NAxqeaaEfoKK1C7Gbus8au8" readonly id="depositAddress">
            </div>
            <div class="form-group">
                <label>Amount (USDT):</label>
                <input type="number" id="depositAmount" placeholder="0.00" step="0.01" min="0.25" value="10.00">
            </div>
            <p style="text-align: center; margin: 20px 0; color: #ffaa00; font-size: 0.9rem;">
                Send exact amount to the address above.<br>
                After 3 network confirmations, balance will update.
            </p>
            <div class="form-buttons">
                <button class="cancel" onclick="closeDepositModal()">CLOSE</button>
                <button class="submit" onclick="copyDepositDetails()">COPY DETAILS</button>
            </div>
        </div>
    </div>
    
    <!-- Withdraw Modal -->
    <div class="modal" id="withdrawModal">
        <div class="modal-content">
            <h2>Withdraw USDT</h2>
            <div class="form-group">
                <label>Amount (USDT):</label>
                <input type="number" id="withdrawAmount" placeholder="0.00" step="0.01" min="0.25" max="1000">
            </div>
            <div class="form-group">
                <label>Wallet Address (TRC20):</label>
                <input type="text" id="withdrawAddress" placeholder="Enter your USDT TRC20 address">
            </div>
            <p style="color: #aaa; font-size: 0.9rem; margin-bottom: 20px;">
                Available: <span id="availableBalance">0.00</span> USDT
            </p>
            <div class="form-buttons">
                <button class="cancel" onclick="closeWithdrawModal()">CANCEL</button>
                <button class="submit" onclick="submitWithdrawal()">SUBMIT</button>
            </div>
        </div>
    </div>
    
    <!-- Withdrawal History Modal -->
    <div class="modal" id="withdrawHistoryModal">
        <div class="modal-content">
            <h2>Withdrawal History</h2>
            <div id="withdrawHistoryList" style="max-height: 300px; overflow-y: auto; margin-top: 20px;">
                <!-- History will be loaded here -->
            </div>
            <div class="form-buttons" style="margin-top: 20px;">
                <button class="cancel" onclick="closeWithdrawHistoryModal()">CLOSE</button>
            </div>
        </div>
    </div>

    <script>
        // Game state
        let balance = 0;
        let selectedSide = null;
        let isSpinning = false;
        let betHistory = [];
        let withdrawalHistory = [];

        // DOM Elements
        const balanceElement = document.getElementById('balanceAmount');
        const coinElement = document.getElementById('coin');
        const betAmountInput = document.getElementById('betAmount');
        const resultMessage = document.getElementById('resultMessage');
        const betHistoryElement = document.getElementById('betHistory');
        const depositModal = document.getElementById('depositModal');
        const withdrawModal = document.getElementById('withdrawModal');
        const withdrawHistoryModal = document.getElementById('withdrawHistoryModal');

        // Initialize game
        function initGame() {
            loadFromStorage();
            updateBalanceDisplay();
            updateBetHistory();
            updateBetButtons();
        }

        // Load data from localStorage
        function loadFromStorage() {
            const savedBalance = localStorage.getItem('headsTailsBalance');
            const savedHistory = localStorage.getItem('headsTailsHistory');
            const savedWithdrawals = localStorage.getItem('headsTailsWithdrawals');
            
            if (savedBalance) balance = parseFloat(savedBalance);
            if (savedHistory) betHistory = JSON.parse(savedHistory);
            if (savedWithdrawals) withdrawalHistory = JSON.parse(savedWithdrawals);
        }

        // Save data to localStorage
        function saveToStorage() {
            localStorage.setItem('headsTailsBalance', balance.toFixed(2));
            localStorage.setItem('headsTailsHistory', JSON.stringify(betHistory));
            localStorage.setItem('headsTailsWithdrawals', JSON.stringify(withdrawalHistory));
        }

        // Update balance display
        function updateBalanceDisplay() {
            balanceElement.textContent = `${balance.toFixed(2)} USDT`;
        }

        // Update bet buttons state
        function updateBetButtons() {
            const betHeadsBtn = document.querySelector('.bet-heads');
            const betTailsBtn = document.querySelector('.bet-tails');
            
            if (selectedSide === 'heads') {
                betHeadsBtn.style.transform = 'scale(1.05)';
                betHeadsBtn.style.boxShadow = '0 0 20px rgba(255, 170, 0, 0.5)';
                betTailsBtn.style.transform = 'scale(1)';
                betTailsBtn.style.boxShadow = 'none';
            } else if (selectedSide === 'tails') {
                betTailsBtn.style.transform = 'scale(1.05)';
                betTailsBtn.style.boxShadow = '0 0 20px rgba(136, 136, 136, 0.5)';
                betHeadsBtn.style.transform = 'scale(1)';
                betHeadsBtn.style.boxShadow = 'none';
            } else {
                betHeadsBtn.style.transform = 'scale(1)';
                betTailsBtn.style.transform = 'scale(1)';
                betHeadsBtn.style.boxShadow = 'none';
                betTailsBtn.style.boxShadow = 'none';
            }
        }

        // Select side (heads or tails)
        function selectSide(side) {
            if (isSpinning) return;
            
            selectedSide = side;
            updateBetButtons();
            
            // Auto-place bet if amount is valid
            const betAmount = parseFloat(betAmountInput.value);
            if (betAmount >= 0.25 && balance >= betAmount) {
                setTimeout(() => placeBet(), 300);
            }
        }

        // Place bet
        function placeBet() {
            if (isSpinning) return;
            
            const betAmount = parseFloat(betAmountInput.value);
            
            // Validate bet
            if (!selectedSide) {
                showResult('Please select Heads or Tails first!', '#ffaa00');
                return;
            }
            
            if (isNaN(betAmount) || betAmount < 0.25) {
                showResult('Minimum bet is 0.25 USDT!', '#ffaa00');
                return;
            }
            
            if (betAmount > balance) {
                showResult('Insufficient balance!', '#ff5555');
                return;
            }
            
            // Deduct bet amount
            balance -= betAmount;
            updateBalanceDisplay();
            
            // Start coin flip animation
            flipCoin();
            
            // Determine result after animation
            setTimeout(() => {
                determineResult(betAmount);
                saveToStorage();
            }, 2000);
        }

        // Flip coin animation
        function flipCoin() {
            if (isSpinning) return;
            
            isSpinning = true;
            coinElement.classList.remove('show-heads', 'show-tails');
            coinElement.classList.add('spinning');
            
            // Disable inputs during spin
            betAmountInput.disabled = true;
            document.querySelectorAll('.bet-button').forEach(btn => btn.disabled = true);
        }

        // Determine game result
        function determineResult(betAmount) {
            // 25% chance to win (1 in 4)
            const isWin = Math.random() < 0.25;
            const winningSide = Math.random() < 0.5 ? 'heads' : 'tails';
            
            // Stop spinning and show result
            coinElement.classList.remove('spinning');
            
            if (winningSide === 'heads') {
                coinElement.classList.add('show-heads');
            } else {
                coinElement.classList.add('show-tails');
            }
            
            // Calculate result
            let winAmount = 0;
            let resultText = '';
            let resultColor = '';
            
            if (isWin && selectedSide === winningSide) {
                // Player wins
                winAmount = betAmount * 2;
                balance += winAmount;
                resultText = `ðŸŽ‰ WIN! +${winAmount.toFixed(2)} USDT`;
                resultColor = '#00ff88';
            } else {
                // Player loses
                resultText = `ðŸ˜¢ LOSE! -${betAmount.toFixed(2)} USDT`;
                resultColor = '#ff5555';
            }
            
            // Save to history
            const historyItem = {
                time: new Date().toLocaleString(),
                amount: betAmount,
                side: selectedSide,
                result: isWin && selectedSide === winningSide ? 'win' : 'lose',
                winAmount: winAmount,
                actualSide: winningSide
            };
            
            betHistory.unshift(historyItem);
            if (betHistory.length > 20) betHistory = betHistory.slice(0, 20);
            
            // Update displays
            showResult(resultText, resultColor);
            updateBalanceDisplay();
            updateBetHistory();
            
            // Re-enable inputs
            setTimeout(() => {
                isSpinning = false;
                betAmountInput.disabled = false;
                document.querySelectorAll('.bet-button').forEach(btn => btn.disabled = false);
                resultMessage.style.display = 'none';
            }, 3000);
        }

        // Show result message
        function showResult(message, color) {
            resultMessage.textContent = message;
            resultMessage.style.color = color;
            resultMessage.style.display = 'block';
            resultMessage.style.background = color + '20';
            resultMessage.style.border = `1px solid ${color}`;
        }

        // Update bet history display
        function updateBetHistory() {
            betHistoryElement.innerHTML = '';
            
            if (betHistory.length === 0) {
                betHistoryElement.innerHTML = '<div class="history-item" style="text-align: center; color: #aaa;">No bets yet</div>';
                return;
            }
            
            betHistory.forEach(item => {
                const historyItem = document.createElement('div');
                historyItem.className = `history-item ${item.result}`;
                historyItem.innerHTML = `
                    <div style="display: flex; justify-content: space-between;">
                        <span>${item.time}</span>
                        <span class="${item.result}">${item.result === 'win' ? '+' : '-'}${item.amount.toFixed(2)} USDT</span>
                    </div>
                    <div style="font-size: 0.8rem; color: #aaa; margin-top: 5px;">
                        Bet: ${item.side.toUpperCase()} | Result: ${item.actualSide.toUpperCase()} 
                        ${item.result === 'win' ? `(Won ${item.winAmount.toFixed(2)} USDT)` : ''}
                    </div>
                `;
                betHistoryElement.appendChild(historyItem);
            });
        }

        // Modal functions
        function showDepositModal() {
            depositModal.style.display = 'flex';
        }

        function closeDepositModal() {
            depositModal.style.display = 'none';
        }

        function copyDepositDetails() {
            const address = document.getElementById('depositAddress').value;
            const amount = document.getElementById('depositAmount').value;
            const text = `Deposit ${amount} USDT to:\n${address}`;
            
            navigator.clipboard.writeText(text).then(() => {
                showResult('Deposit details copied to clipboard!', '#00d4ff');
                setTimeout(() => closeDepositModal(), 1000);
            });
        }

        function showWithdrawModal() {
            if (balance < 0.25) {
                showResult('Minimum withdrawal is 0.25 USDT!', '#ffaa00');
                return;
            }
            
            document.getElementById('withdrawAmount').value = '';
            document.getElementById('withdrawAddress').value = '';
            document.getElementById('availableBalance').textContent = balance.toFixed(2);
            withdrawModal.style.display = 'flex';
        }

        function closeWithdrawModal() {
            withdrawModal.style.display = 'none';
        }

        function submitWithdrawal() {
            const amount = parseFloat(document.getElementById('withdrawAmount').value);
            const address = document.getElementById('withdrawAddress').value.trim();
            
            // Validate withdrawal
            if (isNaN(amount) || amount < 0.25) {
                showResult('Minimum withdrawal is 0.25 USDT!', '#ffaa00');
                return;
            }
            
            if (amount > balance) {
                showResult('Insufficient balance!', '#ff5555');
                return;
            }
            
            if (!address || address.length < 10 || !address.startsWith('T')) {
                showResult('Please enter a valid TRC20 wallet address (starts with T)!', '#ffaa00');
                return;
            }
            
            // Process withdrawal
            balance -= amount;
            
            // Save to withdrawal history
            const withdrawal = {
                time: new Date().toLocaleString(),
                amount: amount,
                address: address,
                status: 'pending'
            };
            
            withdrawalHistory.unshift(withdrawal);
            if (withdrawalHistory.length > 20) withdrawalHistory = withdrawalHistory.slice(0, 20);
            
            // Update displays
            updateBalanceDisplay();
            saveToStorage();
            showResult(`âœ… Withdrawal request submitted for ${amount.toFixed(2)} USDT!`, '#00ff88');
            
            // Close modal
            closeWithdrawModal();
        }

        function showWithdrawHistory() {
            const historyList = document.getElementById('withdrawHistoryList');
            historyList.innerHTML = '';
            
            if (withdrawalHistory.length === 0) {
                historyList.innerHTML = '<div style="text-align: center; color: #aaa; padding: 20px;">No withdrawals yet</div>';
            } else {
                withdrawalHistory.forEach(item => {
                    const itemDiv = document.createElement('div');
                    itemDiv.className = 'history-item';
                    itemDiv.innerHTML = `
                        <div style="display: flex; justify-content: space-between;">
                            <span>${item.time}</span>
                            <span class="status-${item.status}">${item.amount.toFixed(2)} USDT</span>
                        </div>
                        <div style="font-size: 0.8rem; color: #aaa; margin-top: 5px;">
                            Address: ${item.address.substring(0, 20)}...<br>
                            Status: <span class="status-${item.status}">${item.status.toUpperCase()}</span>
                        </div>
                    `;
                    historyList.appendChild(itemDiv);
                });
            }
            
            withdrawHistoryModal.style.display = 'flex';
        }

        function closeWithdrawHistoryModal() {
            withdrawHistoryModal.style.display = 'none';
        }

        // Auto-place bet when Enter is pressed
        document.getElementById('betAmount').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                placeBet();
            }
        });

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', initGame);

    </script>
</body>
</html>
